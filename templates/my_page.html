<!DOCTYPE html>
<html>
<head>
 <title>my page</title>

 <!-- Required meta tags -->
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 <!-- Bootstrap CSS -->
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
 integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
 <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/for_mypage_style.css') }}">

<script src="https://kit.fontawesome.com/d8aadde843.js" crossorigin="anonymous"></script>
 <!-- JS -->
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
 integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
 crossorigin="anonymous"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
 integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
 crossorigin="anonymous"></script>

<style type="text/css">
  html, body {
    font-weight: 400;
    color: white;
    height: 100%;
    background: rgb(20, 21, 23);
    padding: 0px;
    margin: 0px;
  }

  ul {
    list-style-type: none;
    margin-block-end: 0px;
    margin-block-start: 0px;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    padding-inline-start: 0px;
    padding: 0px;
    margin: 0px;  
  }


  #root {
    width: 100%;
    height: 100%;
  }

  .self {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 10px 0px 0px;
  }

  .top_sidebar {
    position: fixed;
    top: 0px;
    z-index: 500;
    font-size: 14px;
    letter-spacing: -0.4px;
    width: 100%;
    height: 72px;
    background-color: rgb(3, 7, 8);
    padding: 0px 4%;
  }

  .ART_cinema_logo {
    position: relative;
    z-index: 10001;
    float: left;
    background-size: 173px 26px;
    width: 173px;
    height: 72px;
  }


  /* nav */

  .left_nav {
    float: center;
    padding-left: 33px;
  }

  .right_nav {
    display: flex;
    position: relative;
    right: -11px;
    float: right;
  }
  
  header {
    margin: 8px 12px;
    display: flex;
    background-color: white;
  }

  .user_profile {
    justify-content: space-between;
    background-color: white;
    width: auto;
    height: auto;
    margin-top: 100px;
    display: flex;
  }



  .user_infos {
    display: flex;
    margin-top: 100px;
    color: white;
  }

  .user_info {
    display: flex;
  }

  .user_info ul {
    padding: 10px 20px;
  }

  .user_profile h1, div{
    color: black;
  }

  .user_profile_img_and_info {
    display: flex;
  }

  .user_img li i {
    width: 80px;
    height: 80px;%;
  }


  .user_img {
  }
  

  /* main - div*/

  .mypage_main {
    flex: 1;
    background: #141517;
  }

  .mypage_main_container {
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
  }

  .header {
    margin-top: 3.2vw;
    padding: 0px 4%;
  }

  .header_title {
    color: rgb(255, 255, 255);
    font-size: 3vw;
    letter-spacing: -0.03125vw;
    line-height: 2.03125vw;
  }

  /* main - section */
  .mypage_list_section {
    position: relative;
    background-color: rgb(20, 21, 23);
    overflow-x: visible;
  }

  .row_list {
    padding-top: 1.01562vw;
    padding-bottom: 2.34375vw;
  }

  .unit_row {
    margin-bottom: 0.546875vw;
  }

  .row_title {
    color: #FFFFFF;
    font-size: 2vw;
    -webkit-letter-spacing: -0.03125vw;
    letter-spacing: -0.03125vw;
    line-height: 2.03125vw;
    padding: 0 4%;
    margin-bottom: 0.703125vw;
    font-family: sans-serif;
  }

  .row_section {
    position: relative;
    white-space: nowrap;
    padding-right: 4%;
    padding-left: 4%;
    overflow-x: visible;
  }

  .fixed_row {
    margin-bottom: 0vw;
  }

  .slide_row {
    position: relative;
  }

  .movie_list_row {
    /* scroll-bar 제어*/
    white-space:nowrap; 
    overflow:auto;
    width:100%; 
    height:auto;
    /*               */
    position: relative;
    white-space: nowrap;
    padding-right: 4%;
    padding-left: 4%;
    overflow-x: visible;
  }

  .movie_list_row_set {
    margin-right: -0.15625vw;
    margin-left: -0.15625vw;
  }

  .movie_ifno_container {
    padding-left: 0;
    display: inline-block;
  }

  .img_and_title {
    z-index: 1;
    padding: 0.15625vw;
    padding-top: 0;
    padding-bottom: 0;
    margin-bottom: 1.5625vw;
    -webkit-transition: -webkit-transform 0.4s cubic-bezier(0.5,0,0.1,1) 0s;
    -webkit-transition: transform 0.4s cubic-bezier(0.5,0,0.1,1) 0s;
    transition: transform 0.4s cubic-bezier(0.5,0,0.1,1) 0s;
  }




  /* 이미지만*/
  .movie_still_cut_container {
    position: relative;
  }

  .movie_img_wrapper {
    position: relative;
    z-index: 3;
  }

 .movie_img_poster {
    position: relative;
    overflow: hidden;
    background-color: #0f1112;
    width: 100%;
    padding: 28.125% 0;position: relative;
    overflow: hidden;
    background-color: #0f1112;
    width: 100%;
    padding: 0;
    margin: 15pt;

 }

 .content_img {
  display: block;
  width: 100%;
  height: auto;
 }

  .movie_img_poster_first {
    position: relative;
    overflow: hidden;
    background-color: #0f1112;
    width: 100%;
    padding: 28.125% 0;position: relative;
    overflow: hidden;
    background-color: #0f1112;
    padding: 0;
    margin: 15pt;

 }

 .director_name_in_img {
   
  color: white;
  font-size: 26px;
  position: absolute;
  top: 20%;
  left: 50%;
  -webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
  text-align: left;
}

.comment_in_img {
  color: white;
  font-size: 16px;
  position: absolute;
  top: 50%;
  left: 10%;
  /*-webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);*/
  transform: translate(0%, -50%);
  text-align: left;
}

 .movie_img_poster_first:hover .overlay {
  opacity: 1;
}

  .movie_img_poster_second {
    display: none;
    position: relative;
    overflow: hidden;
    background-color: #0f1112;
    width: 100%;
    padding: 28.125% 0;position: relative;
    overflow: hidden;
    background-color: #0f1112;
    width: 100%;
    padding: 0;
    margin: 15pt;

 }

  .overlay {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    width: 100%;
    opacity: 0;
    transition: .5s ease;
    background: rgba(3, 3, 8, 0.7);
  }

   .movie_img_poster:hover img {
      -webkit-transform:scale(1.2);
      -moz-transform:scale(1.2);
      -ms-transform:scale(1.2);   
      -o-transform:scale(1.2);
      transform:scale(.95);
  }
  /*타이틀만*/

  .movie_title_wrapper {
    height: 3.125vw;
    margin-top: 0.234375vw;
    opacity: 1;
    -webkit-transition: opacity 0.2s linear 0s;
    transition: opacity 0.2s linear 0s;    
  }

  .movie_title {
    display: block;
    color: rgba(255,255,255,0.95);
    font-size: 1.46484375vw;
    font-weight: 400;
    white-space: pre-wrap;
    word-wrap: break-word;
    word-break: break-word;
    padding: 0 1.015625vw 0 0;
    opacity: 1;
    -webkit-transition: opacity 0.25s cubic-bezier(0.5,0,0.1,1) 0.2s;
    transition: opacity 0.25s cubic-bezier(0.5,0,0.1,1) 0.2s;
  }

  .text {
   
  color: white;
  font-size: 16px;
  position: absolute;
  top: 20%;
  left: 40%;
  -webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
  text-align: left;
}
</style>



<!-- mypage에 필요한 함수 모음-->
 <script type="text/javascript">

  $(document).ready(function(){
    get_session();
  });

  function get_session(){
    nickname = "{{sessionemail2}}"
    console.log(nickname)
    non_login = '<a class="nav=link" href="#" id="btn_home" onclick="btn_home()">로그인을 해야 사용가능합니다.</a>'
    html_logout = '<a class="nav-link" href="#" id="btn_logout" onclick="btn_logout()" style="padding-top:3px;">로그아웃</a>'
    temp_html = '<div style="padding:4px;color:white;">안녕하세요 ' + '<a href="" onclick="btn_my_page('+nickname+')">' + nickname + '</a>님!</div>'

    if("{{sessionemail2}}" == ""){
      $('#menubar').append(non_login)
    }else{
      $('#menubar').append(temp_html);
      $('#menubar').append(html_logout);
    }

    $('#comment_movies_select').html('');
    $('#like_movies_select').html('');
    $('#dislike_movies_select').html('');
  }



  function btn_logout(){
    jbResult = confirm( "정말 로그아웃을 하시겠습니까?" );
    if(jbResult == true){
      $.ajax({
       type: "POST",
       url: "/",
       data: {},
       success: function(response){
       }
     })
      $('#btn_logout').remove();  
    }
    else{
    }
  }

//-------------검색용-------------//
function search_listing(){
  let search_data = $('#movie_input').val();
  if( search_data != ""){
    alert(search_data+'에 대한 정보입니다.');
    go_page5(search_data)
    //url_get(search_data)
  }
  else{
    alert('검색어를 입력해주세요.');
  }
}

//페이지 5 쿼리스트링 수정하면, page5 뒤에 추가
      function go_page5(data){
        location.href="/page5?movie_title="+data
      }


//-------------검색용-------------//
</script>

<!-- ajax -->
<script type="text/javascript">
  
  $(document).ready(function(){
    bring_like_movie_list()
    bring_dislike_movie_list()
    bring_comment_movie_list()
  });


let my_like_movie
let my_dislike_movie  
let my_comment_movie


  function bring_like_movie_list(){
    $.ajax({
      type: "GET",
      url: "/info_my_like_movie",
      data: {},
      success: function(response){
        my_like_movie = response['my_like_movie']
        console.log(my_like_movie)
        $('#like_movies_select').append(my_like_movie);

        if (response['result'] == 'success') {
            my_like_movie = response['my_like_movie'];

          for (let i = 0; i < my_like_movie.length; i++) {
            movie_like_content(my_like_movie[i]['poster'],my_like_movie[i]['title'])
          }
        } else {
          alert('영화 리스트를 받아오지 못했습니다');
        }
      }
    })
  }


  function bring_dislike_movie_list(){
    $.ajax({
      type: "GET",
      url: "/info_my_dislike_movie",
      data: {},
      success: function(response){
        my_dislike_movie = response['my_dislike_movie']
        console.log(my_dislike_movie)
        $('#dislike_movies_select').append(my_dislike_movie);

        if (response['result'] == 'success') {
            my_dislike_movie = response['my_dislike_movie'];

          for (let i = 0; i < my_dislike_movie.length; i++) {
            movie_dislike_content(my_dislike_movie[i]['poster'],my_dislike_movie[i]['title'])
          }
        } else {
          alert('영화 리스트를 받아오지 못했습니다');
        }
      }
    })
  }


  function bring_comment_movie_list(){
    $.ajax({
      type: "GET",
      url: "/info_my_comment_movie",
      data: {},
      success: function(response){
        my_comment_movie = response['my_comment_movie']
        console.log(my_comment_movie)
        $('#comment_movies_select').append(my_comment_movie);

        if (response['result'] == 'success') {
            my_comment_movie = response['my_comment_movie'];
            console.log(my_comment_movie)

          for (let i = 0; i < my_comment_movie.length; i++) {
            movie_comment_content(my_comment_movie[i]['user_comment_movie_poster'],my_comment_movie[i]['user_comment'], my_comment_movie[i]['user_comment_movie_title'])
          }
        } else {
          alert('영화 리스트를 받아오지 못했습니다');
        }
      }
    })
  }

</script>


<!-- html 뿌려주는 -->
<script type="text/javascript">
  function movie_comment_content(poster, user_comment, title){
    let temp_html = '<li class="movie_ifno_container">\
                              <div class="img_and_title">\
                                <div class="movie_still_cut_container">\
                                  <div class="movie_img_wrapper">\
                                    <a href="javascript:void(0);">\
                                      <div class="movie_img_poster_first">\
                                        <img class="content_img" src=" '+ poster +'">\
                                        <div class="overlay">\
                                        <div class="comment_in_img">'+user_comment+'</div>\
                                        <button onclick="search_movies_info()"> 한번보자 </button>\
                                      </div>\
                                      </div>\
                                    </a>\
                                  </div>\
                                </div>\
                                <div class="movie_title_wrapper">\
                                  <h5 class="movie_title">'+ title +'</h5>\
                                </div>\
                              </div>\
                            </li>';
    $('#comment_movies_select').append(temp_html);

    }

  function movie_like_content(poster, title){
    console.log(poster)
    let temp_html = '<li class="movie_ifno_container">\
                              <div class="img_and_title">\
                                <div class="movie_still_cut_container">\
                                  <div class="movie_img_wrapper">\
                                    <a href="javascript:void(0);">\
                                      <div class="movie_img_poster">\
                                        <img class="content_img" src=" '+ poster +'">\
                                      </div>\
                                    </a>\
                                  </div>\
                                </div>\
                                <div class="movie_title_wrapper">\
                                  <h5 class="movie_title">'+ title +'</h5>\
                                </div>\
                              </div>\
                            </li>';
    $('#like_movies_select').append(temp_html);


    }

  function movie_dislike_content(poster, title){
    let temp_html = '<li class="movie_ifno_container">\
                              <div class="img_and_title">\
                                <div class="movie_still_cut_container">\
                                  <div class="movie_img_wrapper">\
                                    <a href="javascript:void(0);">\
                                      <div class="movie_img_poster">\
                                        <img class="content_img" src=" '+ poster +'">\
                                      </div>\
                                    </a>\
                                  </div>\
                                </div>\
                                <div class="movie_title_wrapper">\
                                  <h5 class="movie_title">'+ title +'</h5>\
                                </div>\
                              </div>\
                            </li>';
    $('#dislike_movies_select').append(temp_html);
  }
</script>

<!-- uniq값을 이용하여 poster값을 전달하기 -->

<script type="text/javascript">
  function search_movies_info() {
  $.ajax({
        type: "GET",
        url: "/deliver_poster_data?title_give=" + title,
        data: {}, 
        success: function(response){
          if (response['result'] == 'success') {
                  let mypage_movie_info = response['mypage_movie_info'];
                  console.log(mypage_movie_info);
                  for (let i = 0; i < mypage_movie_info.length; i++) {
              movie_output_test(mypage_movie_info[i]['poster'], mypage_movie_info[i]['user_comment'], mypage_movie_info[i]['title'])
                  }
              } else {
                alert('정보를 받아오지 못했습니다');
              }
        }
      })
}


    function movie_output_test(poster, user_comment, title){
    let temp_html = '<li class="movie_ifno_container">\
                              <div class="img_and_title">\
                                <div class="movie_still_cut_container">\
                                  <div class="movie_img_wrapper">\
                                    <a href="javascript:void(0);">\
                                      <div class="movie_img_poster_first">\
                                        <img class="content_img" src=" '+ poster +'">\
                                        <div class="overlay">\
                                        <div class="comment_in_img">'+user_comment+'</div>\
                                        <button onclick="btn_search_info()"> 자세히 </button>\
                                      </div>\
                                      </div>\
                                    </a>\
                                  </div>\
                                </div>\
                                <div class="movie_title_wrapper">\
                                  <h5 class="movie_title">'+ title +'</h5>\
                                </div>\
                              </div>\
                            </li>';
    $('#like_movies_select').append(temp_html);
}
</script>


<!-- btn 기능 함수 -->
<script type="text/javascript">
function btn_main_page(){
  location.href="/temp"
}

function btn_my_page() {
  location.href="/mypage"
}
function go_page2(){
  location.href="/page2"
}

function btn_home(){
  location.href="/temp"
}

function btn_search_info() {
  location.href = "/page5"
}

</script>

<header>
  <div class="user_profile">
    <div class="user_img"><img src="https://instagram.fhrk8-1.fna.fbcdn.net/v/t51.2885-19/44884218_345707102882519_2446069589734326272_n.jpg?_nc_ht=instagram.fhrk8-1.fna.fbcdn.net&_nc_ohc=rwWGQ6X4qT4AX8nr25h&oh=bee00d9c8811d96b720282ea0308da3b&oe=5F0FB80F&ig_cache_key=YW5vbnltb3VzX3Byb2ZpbGVfcGlj.2"></div>
  </div>
  <section class="user_infos">
    <div class="user_profile_img_and_info">
      <div class="user_info">
        <ul>
          <li>nickname</li>
          <li>원행쓰</li>
        </ul>
        <ul>
          <li>선호 장르</li>
          <li>드라마</li>
        </ul>
      </div>
    </div>
  </section>
</header>


<body>

  <div id="root">
    <div class="self">
      <nav class="top_sidebar" id="menubar">
        <a class="ART_cinema_logo" src="">
          <img src="/static/logo.png" style="width:70px; height:50px; cursor: pointer;" onclick="btn_home()">
        </a>
        <ul class="left_nav">
          <li>
            <input class="keyword" id="movie_input" type="text" name="movie_info_give" maxlength=255 value="" autocomplete="off" placeholder="제목, 감독, 배우를 입력해주세요."  size="80"  onKeypress="javascript:if(event.keyCode==13) {search_listing()}">
            <button onclick="search_listing()">확인</button>
          </li>
        </ul>
        <ul class="right_nav">
          
        </ul>
      </nav>
      <main class="mypage_main">
        <div class="mypage_main_container">
          <section class="mypage_list_section">
            <ul class="row_list">
              <li class="unit_row">
                <h3 class="row_title">댓글 달았어요</h3>
                <section class="row_section">
                  <li class="fixed_row">
                    <div class="slide_row">
                      <div class="movie_list_row" style="">
                        <ul class="movie_list_row_set" style="transform:translate3d(0, 0, 0)" id="comment_movies_select">
                          <li class="movie_ifno_container">
                            <div class="img_and_title">
                              <div class="movie_still_cut_container">
                                <div class="movie_img_wrapper">
                                  <a href="javascript:void(0);">
                                    <div class="movie_img_poster">
                                      <img class="content_img" src="http://www.kobis.or.kr//common/mast/movie/2020/03/thumb_x192/thn_47724c99a09f4873909ac2284748ee45.jpg">
                                    </div>
                                  </a>
                                </div>
                              </div>
                              <div class="movie_title_wrapper">
                                <h5 class="movie_title">기도의 힘</h5>
                              </div>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </li>
                </section>
              </li>
              <li class="unit_row">
                <h3 class="row_title">좋아요</h3>
                <section class="row_section">
                    <li class="fixed_row">
                      <div class="slide_row">
                        <div class="movie_list_row">
                          <ul class="movie_list_row_set" style="transform:translate3d(0, 0, 0)" id="like_movies_select">

                            <!-- like_temp_html 적용부분 -->
                            <li class="movie_ifno_container">
                              <div class="img_and_title">
                                <div class="movie_still_cut_container">
                                  <div class="movie_img_wrapper">
                                    <a href="javascript:void(0);">
                                      <div class="movie_img_poster">
                                        <img class="content_img" name="toggle_control" id="show_hide_img" src="http://www.kobis.or.kr//common/mast/movie/2020/03/thumb_x192/thn_47724c99a09f4873909ac2284748ee45.jpg">
                                      </div>
                                    </a>
                                  </div>
                                </div>
                                <div class="movie_title_wrapper">
                                  <h5 class="movie_title">기도의 힘</h5>
                                </div>
                              </div>
                            </li>

                          </ul>
                        </div>
                      </div>
                    </li>
                </section>
              </li>
              <li class="unit_row">
                <h3 class="row_title">싫어요</h3>
                <section class="row_section">
                    <li class="fixed_row">
                      <div class="slide_row">
                        <div class="movie_list_row">
                          <ul class="movie_list_row_set" style="transform:translate3d(0, 0, 0)" id="dislike_movies_select">
                            <li class="movie_ifno_container">
                              <div class="img_and_title">
                                <div class="movie_still_cut_container">
                                  <div class="movie_img_wrapper">
                                    <a href="javascript:void(0);">
                                      <div onclick="openclose()" class="movie_img_poster_first">
                                        <img class="content_img" src="http://www.kobis.or.kr//common/mast/movie/2020/03/thumb_x192/thn_47724c99a09f4873909ac2284748ee45.jpg">
                                        <div class="overlay">
                                          <div class="director_name_in_img">알렉스 켄드릭</div>
                                          <div class="comment_in_img">재밌어요!</div>
                                          <button onclick="btn_main_page()"> 자세히 </button>
                                        </div>
                                      </div>
                                    </a>
                                  </div>
                                </div>
                                <div class="movie_title_wrapper">
                                  <h5 class="movie_title">기도의 힘</h5>
                                </div>
                              </div>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </li>
                </section>
              </li>
            </ul>
          </section>
        </div> 
      </main>
    </div>
  </div>
</body>
</html>